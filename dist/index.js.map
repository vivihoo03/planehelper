{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///external \"three\"","webpack:///./src/index.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","three","THREE","three_1","PlaneHelper","plane","xRay","this","yRay","normal","clone","cross","createPlane","origin","normal3","Vector3","copy","origin3","xRay3","constant","normalize","dot","planeHp","Plane","setOrigin","Normal","v","convertTo2D","point","sub","planeVec","xval","yval","Vector2","convertTo3D","multiplyScalar","x","add","y","convertTo2DVec","converTo3DVec","vec","intersectInfinityLine","line","result","direction","delta","denominator","distanceToPoint","start","intesectLine","interPnt","intersectLine","console","warn","Error","intersectSegment","segment","projectPoint","target","applyMatrix4","mat","getTransMatrix","xDir","yDir","zDir","Matrix4","makeBasis","toMetaData","Origin","xray","XRay"],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","module.exports = three;","\r\n\"use strict\";\r\n/**\r\n * PlaneHelper is helperful to switch between \r\n * 2d and 3d plane point operation\r\n **/\r\n\r\nimport * as THREE from 'three';\r\nimport { Vector3 as V3, Plane as P3 } from 'three'; \r\n\r\ninterface XYZ {\r\n    x: number;\r\n    y: number;\r\n    z: number;\r\n}\r\n\r\ninterface XY {\r\n    x: number;\r\n    y: number;\r\n}\r\n\r\nexport class PlaneHelper {\r\n    private plane: P3\r\n\r\n    private xRay: V3\r\n\r\n    private yRay: V3\r\n\r\n    private origin: V3\r\n\r\n    static createPlane(normal: XYZ, origin: XYZ, xRay: XYZ) : PlaneHelper {\r\n        let normal3 = new V3().copy((normal as V3));\r\n        let origin3 = new V3().copy((origin as V3));\r\n        let xRay3 = new V3().copy((xRay as V3));\r\n        const constant = normal3.normalize().dot(origin3);\r\n        const planeHp = new PlaneHelper(new P3(normal3, -constant), xRay3);\r\n        planeHp.setOrigin(origin3);\r\n        return planeHp;\r\n    }\r\n\r\n    static copy(planeHp: PlaneHelper) {\r\n        let { Normal, origin, xRay} = planeHp;\r\n        Normal = new V3().copy(Normal);\r\n        origin = new V3().copy(origin);\r\n        xRay = new V3().copy(xRay);\r\n        return  PlaneHelper.createPlane(Normal, origin, xRay);\r\n    }\r\n\r\n\r\n    constructor(plane: P3, xRay: V3) {\r\n        this.plane = plane;\r\n        this.xRay = xRay;\r\n        this.yRay = plane.normal.clone().cross(xRay);\r\n    }\r\n\r\n    get Normal(): V3 {\r\n        return this.plane.normal;\r\n    }\r\n\r\n    get Origin(): V3 {\r\n        return this.origin;\r\n    }\r\n\r\n    set Origin (v: V3) {\r\n        this.origin = new V3().copy((v as V3));\r\n    }\r\n\r\n    get XRay(): V3 {\r\n        return this.xRay;\r\n    }\r\n\r\n    set XRay(v: V3) {\r\n        this.xRay = new V3().copy((v as V3));\r\n    }\r\n\r\n    get YRay(): V3 {\r\n        return this.yRay;\r\n    }\r\n\r\n    set YRay(v: V3) {\r\n        this.yRay = new V3().copy((v as V3));\r\n    }\r\n\r\n    public setOrigin(origin: XYZ) {\r\n        this.origin = new V3().copy((origin as V3));\r\n    }\r\n\r\n    public convertTo2D(point: V3) {\r\n        if (point && !point.sub) point = new V3().copy(point);\r\n        const planeVec = point.sub(this.origin);\r\n        const xval = planeVec.dot(this.xRay);\r\n        const yval = planeVec.dot(this.yRay);\r\n        return new THREE.Vector2(xval, yval);\r\n    }\r\n\r\n    public convertTo3D(point: XY) {\r\n        return this.xRay.clone().multiplyScalar(point.x).add(this.yRay.clone().multiplyScalar(point.y)).add(this.origin);\r\n    }\r\n\r\n    public convertTo2DVec(point) {\r\n        if (point && !point.sub) point = new V3().copy(point);\r\n        const planeVec = point;\r\n        const xval = planeVec.dot(this.xRay);\r\n        const yval = planeVec.dot(this.yRay);\r\n        return new THREE.Vector2(xval, yval);\r\n    }\r\n\r\n    public converTo3DVec(vec) {\r\n        return this.xRay.clone().multiplyScalar(vec.x).add(this.yRay.clone().multiplyScalar(vec.y));\r\n    }\r\n\r\n    public intersectInfinityLine(line) {\r\n        const result = new V3();\r\n        const direction = line.delta(new V3());\r\n        const denominator = this.plane.normal.dot(direction);\r\n    \r\n        if (denominator === 0) {\r\n            // line is coplanar, return origin\r\n            if (this.plane.distanceToPoint(line.start) === 0) {\r\n                return result.copy(line.start);\r\n            }\r\n            // unsure if this is the correct method to handle this case.\r\n            return undefined;\r\n        }\r\n    \r\n        const t = -(line.start.dot(this.plane.normal) + this.plane.constant) / denominator;\r\n    \r\n        return result.copy(direction).multiplyScalar(t).add(line.start);\r\n    }\r\n\r\n    public intesectLine(line) {\r\n        let interPnt = this.plane.intersectLine(line, new V3());\r\n        if (!(interPnt instanceof V3)) {\r\n            console.warn('Intersect with finity line failed. Try use Infinity.');\r\n            interPnt = this.intersectInfinityLine(line);\r\n            if (!(interPnt instanceof V3)) {\r\n                throw new Error('Intersect with line error.');\r\n            }\r\n        }\r\n        return interPnt;\r\n    }\r\n\r\n    public intersectSegment(segment) {\r\n        return this.plane.intersectLine(segment, new V3());\r\n    }\r\n\r\n    public projectPoint(point, target) {\r\n        return this.plane.projectPoint(point, target);\r\n    }\r\n\r\n    public applyMatrix4(mat: THREE.Matrix4) {\r\n        this.plane.applyMatrix4(mat);\r\n        this.xRay.applyMatrix4(mat);\r\n        this.yRay.applyMatrix4(mat);\r\n        return this;\r\n    }\r\n\r\n    public getTransMatrix() {\r\n        let plane = PlaneHelper.copy(this);\r\n        let xDir = new V3().copy(plane.xRay);\r\n        let yDir = new V3().copy(plane.yRay);\r\n        let zDir = new V3().copy(plane.Normal);\r\n        let baseMatrix = new THREE.Matrix4().makeBasis(xDir, yDir, zDir);\r\n        return baseMatrix;\r\n    }\r\n\r\n    public toMetaData() {\r\n        return {\r\n            origin: this.Origin,\r\n            xray: this.XRay,\r\n            normal: this.Normal,\r\n        };\r\n    }\r\n}"],"sourceRoot":""}